<h1>Dpa Exceptions</h1>

<p class="text-gray-500 text-sm mx-4">
  DPA exceptions - Data Protection Addendums (<%= link_to 'https://it.umich.edu/information-technology-policies/general-policies/DS-20' %>)
</p>

<div data-controller='filters' data-filters-visible-value="true" data-filters-hidden-class="hidden" class="m-2">
  <button type="button" class="bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
    data-action='click->filters#updateHiddenClass'>
  Filters
  </button>
  
  <div data-filters-target='displayfilters' class="m-4 hidden">
    <div class="form-container">
      <div class="field-container">
        <%= search_form_for @q do |f| %>
          <div class="field flex flex-row flex-nowrap justify-items-start items-center">
            <%= f.label :review_date_exception_first_approval_date %>
            <div class="w-1/3 pr-4 pl-2">
              <%= f.text_field :review_date_exception_first_approval_date_gteq, placeholder: "From",
              data: {
                controller: "flatpickr",
                flatpickr_date_format: "Y-m-d",
                flatpickr_min_date: Time.zone.now
              } %>
            </div>

            <div class="w-1/3">
              <%= f.text_field :review_date_exception_first_approval_date_lteq, placeholder: "To",
              data: {
                controller: "flatpickr",
                flatpickr_date_format: "Y-m-d",
                flatpickr_min_date: Time.zone.now
              } %>
            </div>
          </div>
          <div class="field flex flex-row flex-nowrap justify-items-start items-center">
            <%= f.label :third_party_product_service %>
            <div class="w-1/2 pl-2">
              <%= f.text_field :third_party_product_service_cont, placeholder: "Contains", class: 'form-control' %>
            </div>
          </div>
          <div class="field flex flex-row flex-nowrap justify-items-start items-center">
            <%= f.label :used_by %>
            <div class="w-1/2 pl-2">
              <%= f.select :used_by_cont, @used_by, placeholder: "Contains", class: 'form-control' %>


            
            </div>
          </div>
          <%= link_to "Clear", request.path, class: "btn btn-default" %>
          <%= f.submit class: 'btn btn-primary' %>
        <% end %>
      </div>
    </div>
  </div>  
</div>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <% if has_ad_access?(current_user, "dpa_exceptions", "newedit_action") %>
      <div class="btn-new btn-blue" role="menu" aria-orientation="vertical" aria-labelledby="mobile-menu-button" tabindex="-1">
        <%= link_to 'New Dpa Exception', new_dpa_exception_path %>
      </div>
    <% end %>

    <span class="display-filters-result">
    Total number of records: <%= "#{@total}" %>
    </span>

    <div class="flex flex-col">
      <div class="py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8">
        <div class="shadow overflow-hidden border-b border-gray-200 sm:rounded-lg">
          <table>
            <thead>
              <tr>
                <th scope="col">Actions</th>
                <th scope="col"><%= sort_link(@q, :review_date_exception_first_approval_date, 'Review date exception first approval date') %></th>
                <th scope="col">Third party product service</th>
                <th scope="col"><%= sort_link(@q, :used_by, 'Used by', default_order: :desc) %></th>
                <th scope="col">Point of contact</th>
                <th scope="col">Review findings</th>
                <th scope="col">Review summary</th>
                <th scope="col">Lsa security recommendation</th>
                <th scope="col">Lsa security determination</th>
                <th scope="col">Lsa security approval</th>
                <th scope="col">Lsa technology services approval</th>
                <th scope="col">Exception approval date exception renewal date due</th>
                <th scope="col">Review date exception review date</th>
                <th scope="col">Notes</th>
                <th scope="col">Sla agreement</th>
                <th scope="col">Data type</th>
              </tr>
            </thead>
            <%= turbo_frame_tag :search_result do %>
              <%= render "search_result", dpa_exceptions: @dpa_exceptions %>
            <% end %>
          </table>
        </div>

      </div>
    </div>
  </div>
